% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plotting_stats.R
\name{plot_beta_div}
\alias{plot_beta_div}
\title{Plot Beta Diversity Ordination with Statistical Annotations}
\usage{
plot_beta_div(
  ps,
  dist_matrix,
  beta_div,
  group_variable,
  add_ellipse = FALSE,
  cols = NULL,
  shape = NULL
)
}
\arguments{
\item{ps}{A phyloseq object containing the microbiome data and sample metadata.}

\item{dist_matrix}{A distance matrix (class "dist") calculated from the phyloseq object.}

\item{beta_div}{output of \code{calc_betadiv()}, containing the ordination and distance matrix.}

\item{group_variable}{A character string specifying the metadata variable to use for
grouping samples.}

\item{add_ellipse}{A logical value indicating whether to add confidence ellipses around
groups. Default is \code{FALSE}.}

\item{cols}{A vector of colors to use for the groups. Default is \code{NULL} (auto-generated).}

\item{shape}{A character string specifying an optional metadata variable to use for
point shapes. Default is \code{NULL}.}
}
\value{
A ggplot object representing the ordination plot with PERMANOVA statistics
in the caption.
}
\description{
This function creates a beta diversity ordination plot (PCoA/NMDS) from a phyloseq
object with PERMANOVA (adonis) results displayed as a caption. It also checks for
homogeneity of group dispersions and warns if significant.
}
\examples{
# Example usage:
# beta <- calc_betadiv(ps, dist = "bray", ord_method = "PCoA")
# plot_beta_div(ps, beta$Distance_Matrix, beta$Ordination, "Treatment")

}
